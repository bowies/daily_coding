--ANSI SQL
SELECT
    P.PRODUCT_CODE,
    SUM(P.PRICE * O.SALES_AMOUNT) AS SALES
FROM
    PRODUCT P,
    OFFLINE_SALE O
WHERE
    P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY
    P.PRODUCT_CODE
ORDER BY
    SALES DESC,
    P.PRODUCT_CODE;

--mysql 것도 ansi sql 표준에 맞춰져 있지만 oracle 것이 더 가독성이 좋아 보인다. (inner join )


--Mysql
SELECT
    P.PRODUCT_CODE,
    (P.PRICE * SUM(SALES_AMOUNT)) AS SALES
FROM
    PRODUCT P
        JOIN
    OFFLINE_SALE O
    ON
            P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY
    P.PRODUCT_CODE
ORDER BY
    SALES DESC,
    P.PRODUCT_CODE;

--Oracle
SELECT
    P.PRODUCT_CODE,
    SUM(P.PRICE * SALES_AMOUNT) AS SALES
FROM
    PRODUCT P
        INNER JOIN
    OFFLINE_SALE O
    ON
            P.PRODUCT_ID = O.PRODUCT_ID
GROUP BY
    P.PRODUCT_CODE
ORDER BY
    SALES DESC,
    P.PRODUCT_CODE;